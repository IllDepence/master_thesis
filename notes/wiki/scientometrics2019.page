### analysis

##### citation marker surrounding patterns

* use context export (`items_all_` file)
    * save `<cited doc id>|<patt>` in CSV ✔
        * group by cited doc
        * cluster docs by (most common) pattern
        * look at diversity of patts in much cited docs
        * ...
    * save `<cited doc id>|<noun phrase preceding marker>` in CSV
        * group by NP 
        * analyze how predictive NP for cited doc is

**verification of manual sample count of cit. contexts referencing a specific part of the cited document** (cs 5, math 17, phys 4, other 7)
```
(highest in conditional probability from sentence_end_patt_comparison.txt)

NNP¦CD¦IN¦<EOS>     0.995       - The implication FORMULA is a particular case of
                                  J. Hagler's Theorem 1 of [].
                                  (1211.1719)
                                - We follow the strategy of Lemma 6 in [].
                                  (1708.09712)
                                - ... with higher ranks (cf. Definition 3.1 in []).
                                  (1204.6548)

$ cat context_patts_all_2018.csv | grep 'NNP¦CD¦IN¦\[]¦' > context_patts_specific_part_in_cited.csv
$ wc -l context_patts_specific_part_in_cited.csv
251123
```
**TODO:** get fos (mby of both sides?) from above

##### missing links

```
all links:     15,846,351
matching_links: 9,882,069
    -> 62% of unarXive links found in MAG
    -> unarXive has 60% more (160%) citation interlinkgs
        -> are they correct and therefore missing in the MAG?


$ wc -l missing_links.txt 
    5964282 missing_links.txt

>>> SAMPLE GENERATION <<<
$ cat missing_links.txt | shuf | head -n 300 > missing_links_sample.txt
```

```
eval:

--- unarXive only ---

total: 150

general indicator of quality of "not in MAG" subset of links:
  valid: 146 (0.97)
  invalid: 4 (0.03)

indicators for "we have X, which is missing in MAG:"
  valid missing Feb 2019: 146 verified -> ~5805234.48
  valid missing Aug 2019: 115 verified -> ~4572616.20

misc
  papers w/ 0 references in MAG: 53 (0.35)

--- MAG only ---

total: 150

general indicator of quality of "not in unarXive" subset of links:
  valid: 142 (0.95)
  invalid: 8 (0.05)

- - - - - -

stats mc statsface

unarXive       lower    upper
  Wilson(95)   0.9334   0.9896
  Wilson(99)   0.9145   0.9920
  Jeffreys(95) 0.9379   0.9909
  Jeffreys(99) 0.9235   0.9942

MAG
  Wilson(95)   0.8983   0.9727
  Wilson(99)   0.8778   0.9777
  Jeffreys(95) 0.9019   0.9745
  Jeffreys(99) 0.8850   0.9807
```

for all 994,351 where a citing MAG ID is available:

* combined number of cited docs
    * 5,918,128 only in unarXive
    * 9,829,797 in both
    * 10,457,909 only in MAG

* number of cited docs where
    * unarXive has more cited docs: 401,046 (←those have an average (total) number of 17.46 cited docs)
    * MAG has more cited docs: 545,048 (←these have an average (total) number of 34.28 cited docs)
     * only MAG *additional* references: 241,617
     * only unarXive has *additional* references: 265,591
     * only MAG has references *at all*: 0
     * only unarXive has references *at all*: 215,291

##### MAG citation context cleanliness

```
select count(*) from papercitationcontexts where length(citationcontext) < 25;  -> 6160945      (/209606017 = 2,9%)
```
```
MAG19=> select count(*) from papercitationcontexts where substring(citationcontext from 1 for 1) = '[' or substring(citationcontext from 1 for 1) = '(' or substring(citationcontext from 1 for 1) = ',' or substring(citationcontext from 1 for 1) = ';';
  count   
----------
 15905521  -> 7.5%
```
```
select count(*) from papercitationcontexts where substring(citationcontext from 1 for 1) = lower(substring(citationcontext from 1 for 1));  -> 53928293     (/209606017= 26%)  <- lower case or non letter
select count(*) from papercitationcontexts where substring(citationcontext from 1 for 1) = upper(substring(citationcontext from 1 for 1));  -> 183538158    (/209606017 = 88%)  <- upper case or non letter
(53928293+183538158)-209606017 = 27860434 (13%) non letter
(53928293-27860434)/209606017 = 12% lower case
```

##### inflow

TODO: add notes